<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./css2/dashboard.css">
  <title>Projeto IoT - Sobre</title>

</head>

<body style="margin: 0; padding: 0;">
  <div>
    <h1
      style=" margin-left: 30px; font-family:  -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; color: #090a0f;">
      BOLTTECH FUNCIONARIOS</h1>
  </div>
  <div class="contatofunc">
    <div class="contatofunc">

      <div class="formulario">
        <h1
          style="font-family:  -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;   color: #FFF;">
          Fa√ßa aqui seu cadastro!</h1>
        <form id="form_cadastro2" method="post" onsubmit="return cadastrar2()">

          <p>Nome Completo</p>
          <input type="text" name="nomeUsuario" class="input-padrao" placeholder="seu nome completo" required
            minlength="4">


          <p>Email</p>
          <input type="text" name="Email" class="input-padrao" autofocus="autofocus" placeholder="Email" required
            minlength="4">

          <p>Celular</p>
          <input type="text" name="Celular" class="input-padrao" placeholder="seu celular" required>

          <p>Senha</p>
          <input type="password" name="senha" class="input-padrao" placeholder="***************" required minlength="4">



          <input style="display: none;" type=" text" id="fkEmpresa" name="fkEmpresa">

          <input type="submit" id="btn_entrar" value="Cadastrar" class="btn-greenfunc">
        </form>



        <div id="div_erro" style="background-color: sandybrown; color: maroon; display: none;">
          Erro no cadastro
        </div>

      </div>
      <div class="imagem-lateral">
        <img src="./css2/img/funcman.jpg" id="img_aguarde" style=" height: 500px; width:650px; border-radius: 10px;">
      </div>
    </div>
  </div>




</body>

</html>

<script>
  window.onload = function () {
    fkEmpresa.value = sessionStorage.id_usuario_meuapp;
    fkEmpresa.setAttribute("value", sessionStorage.id_usuario_meuapp);
    console.log(fkEmpresa)
  };
  function cadastrar2() {

    aguardar2();
    var formulario = new URLSearchParams(new FormData(form_cadastro2));
    fetch("/usuarios/cadastrar2", {
      method: "POST",
      body: formulario
    }).then(function (response) {

      if (response.ok) {

        window.location.href = 'funclog.html';

      } else {

        console.log('Erro de cadastro!');
        response.text().then(function (resposta) {
          div_erro.innerHTML = resposta;
        });
        finalizar_aguardar2();
      }
    });

    return false;
  }

  function aguardar2() {
    btn_entrar.disabled = true;
    img_aguarde.style.display = 'block';
    div_erro.style.display = 'none';
  }

  function finalizar_aguardar2() {
    btn_entrar.disabled = false;
    img_aguarde.style.display = 'none';
    div_erro.style.display = 'block';
  }

</script>